{{ $page := . }}

{{ range last 1 ( where $.Site.RegularPages "Params.version" "!=" nil) }}
    {{ $page = . }}
{{ end }}

{{ if isset .Params "version" }}
    {{ $page = . }}
{{ end }}

<script src="/js/toc.js" type="text/javascript"></script>

<div class="container pt-5">
<div class="row">
<div class="col-12">      
<h1 style="text-align: center">Homie: An MQTT Convention for IoT/M2M</h1>
</div>
</div>
</div>

<div class="md-grid">
  
<aside class="md-sidebar md-sidebar--secondary d-print-none"
    data-md-state="lock" id="toc">
</aside>

<main class="md-content">
    <tt class="d-print-none">
        License: <a title="Creative Commons Attribution 4.0 International Public License" href="/license">CCA 4.0</a><br>
        Version:
    {{ $versionedPages := where $.Site.RegularPages "Params.version" "!=" nil }}
    {{ range $vpage := $versionedPages }}
        {{ if eq $vpage.Params.version $page.Params.version }}
        [{{ $vpage.Params.version }}]
        {{ else }}
        [<a title="Released {{ $vpage.Params.releasedate }}"
            href="{{ .URL }}">{{ $vpage.Params.version }}</a>]
        {{ end }}
    {{ end }}<br>
        Release date: {{ $page.Params.releasedate }}
    <hr>
    </tt>

    <details class="d-print-none mb-4">
        <summary>Frequently asked questions</summary>
        {{ partial "faq.html" . }}
    </details>

    <h2>Abstract</h2>
    <p>The Homie convention defines a standardized way of how IoT devices and services announce themselves and their data on the MQTT broker. The Homie convention is thereby a crucial aspect on top of the MQTT protocol for <b>automatic discovery</b>, <b>configuration</b> and <b>usage</b> of devices and services."</p>

    <div class="d-none d-print-block">
        <h2>License</h2>
        <p>By exercising the Licensed Rights (defined on https://creativecommons.org/licenses/by/4.0/), You accept and agree to be bound by the terms and conditions of this Creative Commons Attribution 4.0 International Public License ("Public License"). To the extent this Public License may be interpreted as a contract, You are granted the Licensed Rights in consideration of Your acceptance of these terms and conditions, and the Licensor grants You such rights in consideration of benefits the Licensor receives from making the Licensed Material available under these terms and conditions.</p>
    </div>
    
    <div class="d-none d-print-block" id="printtoc">
        <h2>Table of Contents</h2>
    </div>
    {{ range where $.Site.RegularPages "Params.preface" "!=" nil }}
        {{ .Content }}
    {{ end }}

    {{ $page.Content }}
</main>

<script>
const varlist = initTOC({selector:'h2, h3, h4, h5, h6',overwrite:false,prefix:'toc' });
document.getElementById("toc").appendChild(varlist.cloneNode(true));
document.getElementById("printtoc").appendChild(varlist);
</script>
    
</div>